import{d as K,p as A,b as H,f as c,a as O,i as k,w as _,S as j,n as S,T}from"./DrosdPGj.js";import{P as b,L,g as N,R as B,t as C,y as v,z as R,A as I,B as w,C as E,D as q,E as F}from"./Dh0BTbxv.js";const V=K({props:{vnode:{type:Object,required:!0},route:{type:Object,required:!0},vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(e){const i=e.renderKey,n=e.route,a={};for(const r in e.route)Object.defineProperty(a,r,{get:()=>i===e.renderKey?e.route[r]:n[r]});return A(b,H(a)),()=>c(e.vnode,{ref:e.vnodeRef})}}),Q=K({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(e,{attrs:i,expose:n}){const a=C(),r=O(),o=k(b,null);let u;n({pageRef:r});const d=k(L,null);let s;const f=a.deferHydration();if(a.isHydrating){const t=a.hooks.hookOnce("app:error",f);N().beforeEach(t)}return e.pageKey&&_(()=>e.pageKey,(t,g)=>{t!==g&&a.callHook("page:loading:start")}),()=>c(B,{name:e.name,route:e.route,...i},{default:t=>{const g=D(o,t.route,t.Component),m=o&&o.matched.length===t.route.matched.length;if(!t.Component){if(s&&!m)return s;f();return}if(s&&d&&!d.isCurrent(t.route))return s;if(g&&o&&(!d||d!=null&&d.isCurrent(o)))return m?s:null;const l=v(t,e.pageKey);!a.isHydrating&&!G(o,t.route,t.Component)&&u===l&&a.callHook("page:loading:end"),u=l;const y=!!(e.transition??t.route.meta.pageTransition??R),x=y&&z([e.transition,t.route.meta.pageTransition,R,{onAfterLeave:()=>{a.callHook("page:transition:finish",t.Component)}}].filter(Boolean)),h=e.keepalive??t.route.meta.keepalive??I;return s=w(T,y&&x,E(h,c(j,{suspensible:!0,onPending:()=>a.callHook("page:start",t.Component),onResolve:()=>{S(()=>a.callHook("page:finish",t.Component).then(()=>a.callHook("page:loading:end")).finally(f))}},{default:()=>{const p=c(V,{key:l||void 0,vnode:t.Component,route:t.route,renderKey:l||void 0,trackRootNodes:y,vnodeRef:r});return h&&(p.type.name=t.Component.type.name||t.Component.type.__name||"RouteProvider"),p}}))).default(),s}})}});function z(e){const i=e.map(n=>({...n,onAfterLeave:n.onAfterLeave?q(n.onAfterLeave):void 0}));return F(...i)}function D(e,i,n){if(!e)return!1;const a=i.matched.findIndex(r=>{var o;return((o=r.components)==null?void 0:o.default)===(n==null?void 0:n.type)});return!a||a===-1?!1:i.matched.slice(0,a).some((r,o)=>{var u,d,s;return((u=r.components)==null?void 0:u.default)!==((s=(d=e.matched[o])==null?void 0:d.components)==null?void 0:s.default)})||n&&v({route:i,Component:n})!==v({route:e,Component:n})}function G(e,i,n){return e?i.matched.findIndex(r=>{var o;return((o=r.components)==null?void 0:o.default)===(n==null?void 0:n.type)})<i.matched.length-1:!1}export{Q as _};
